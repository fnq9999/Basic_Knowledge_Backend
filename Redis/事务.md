事务
====




### 数据库缓存一致性

- 延迟双删
  - 先删缓存，再更新库，再睡多少Ms再删缓存
  - 问题:如果第二次删缓存失败了，那么就不一致了  
- 库后删存
    - 消息队列
      - 删缓存失败之后，将删除任务放到mq中，创建一个消费者，消费该任务，进行删缓存
    - canal开源订阅binlog
        - 通过一个服务来监听 binlog 的变化（比如阿里的 canal），然后在客户端完成删除 key 的操作。如果删除失败的话，再发送到消息队列。
    - 分布式锁原子操作
    - 队列化
    - 问题
        - 一种概率较低发生问题的情况是:而读操作必需在写操作前进入数据库操作，
          而又要晚于写操作更新缓存。这种情况出现问题